# 线性代数

对于机器学习而言，矩阵、张量是最基本的单位。这里是关于矩阵运算的定义和代码。

给定一个矩阵A
```text
tensor([[ 0.,  1.,  2.,  3.],
        [ 4.,  5.,  6.,  7.],
        [ 8.,  9., 10., 11.],
        [12., 13., 14., 15.],
        [16., 17., 18., 19.]])
```
我们有以下运算

### 转置矩阵
该运算会通过主对角线进行对称交换运算

> A.T

输出
```text
tensor([[ 0.,  4.,  8., 12., 16.],
        [ 1.,  5.,  9., 13., 17.],
        [ 2.,  6., 10., 14., 18.],
        [ 3.,  7., 11., 15., 19.]])
```
### 相同形状的二维运算
相同形状的张量在进行二元运算后的结果也是相同形状的张量
> B = A.clone()<br>
> A + B
```text
tensor([[ 0.,  2.,  4.,  6.],
        [ 8., 10., 12., 14.],
        [16., 18., 20., 22.],
        [24., 26., 28., 30.],
        [32., 34., 36., 38.]])
```

### 哈达玛积
两个矩阵的元素乘法被称为“哈达玛积”，该算法不改变矩阵形状
> A * B
```text
tensor([[  0.,   1.,   4.,   9.],
        [ 16.,  25.,  36.,  49.],
        [ 64.,  81., 100., 121.],
        [144., 169., 196., 225.],
        [256., 289., 324., 361.]])
```
> 2 + A
```text
tensor([[ 2.,  3.,  4.,  5.],
        [ 6.,  7.,  8.,  9.],
        [10., 11., 12., 13.],
        [14., 15., 16., 17.],
        [18., 19., 20., 21.]])
```
> 2 * A
```text
tensor([[ 0.,  2.,  4.,  6.],
        [ 8., 10., 12., 14.],
        [16., 18., 20., 22.],
        [24., 26., 28., 30.],
        [32., 34., 36., 38.]])
```
### 求和

给定一个X张量
```text
tensor([[[ 0,  1,  2,  3],
         [ 4,  5,  6,  7],
         [ 8,  9, 10, 11]],

        [[12, 13, 14, 15],
         [16, 17, 18, 19],
         [20, 21, 22, 23]]])
```
求和操作
```python
# 求和
print(X.sum())
# 对维度求和,也就是沿特定轴进行压扁求和~
print(X.sum(axis=1))
print(X.sum(axis=2))
print(X.sum(axis=[0, 1]))
```
输出为
```text
tensor(276)
tensor([[12, 15, 18, 21],
        [48, 51, 54, 57]])
tensor([[ 6, 22, 38],
        [54, 70, 86]])
tensor([60, 66, 72, 78])
tensor([[ 6.],
```
而你可以尝试保持维度，这样可以利用广播机制进行一些操作，例如
```python
# 保持维数不变
sum_A = A.sum(axis=1, keepdims=True)
print(sum_A)
print(A / sum_A)
```
输出
```text
tensor([[ 6.],
        [22.],
        [38.],
        [54.],
        [70.]])
tensor([[0.0000, 0.1667, 0.3333, 0.5000],
        [0.1818, 0.2273, 0.2727, 0.3182],
        [0.2105, 0.2368, 0.2632, 0.2895],
        [0.2222, 0.2407, 0.2593, 0.2778],
        [0.2286, 0.2429, 0.2571, 0.2714]])
```

### 矩阵向量乘法
```python
x = torch.arange(4, dtype=torch.float32)
print(torch.mv(A, x))
```
### 矩阵乘法
```python
B = torch.ones(4, 3)
print(torch.mm(A, B))
```

### 范数
```python
# 范数
u = torch.tensor([3.0, -4.0])
print(torch.norm(u))

# L1范数，向量元素的绝对值求和
print(torch.abs(u).sum())

# F范数（弗罗贝尼乌斯范数），矩阵元素的平方和的平方根
print(torch.norm(torch.ones(4, 9)))
```